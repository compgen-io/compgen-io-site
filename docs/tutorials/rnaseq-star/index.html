<!DOCTYPE html>
<html class="no-js" lang="en-US" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">
<head>
    <meta charset="utf-8">

        <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-83662616-1', 'auto');
  ga('send', 'pageview');

</script>


    <base href="https://compgen.io/">
    <title>compgen.io - rna-seq workflow (with star)</title>
    <link rel="canonical" href="https://compgen.io/tutorials/rnaseq-star/">

    <link href='https://fonts.googleapis.com/css?family=Lato:400,300,100' rel='stylesheet' type='text/css'>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" crossorigin="anonymous">





<link rel="stylesheet/less" type="text/css" href="/css/style.less" />

<script src="/js/less.min.js" type="text/javascript"></script>
<link rel="shortcut icon" href="/favicon.ico" />

</head>
<body lang="en">

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

<div class="header_wrap">
<div class="header">
  <div class="logo"><a href="/"><img src="/img/compgen-logo.png" alt="compgen.io"/></a></div>
  <div class="slogan">data wrangling for<br/>computational genomics</div>
  <ul class="links">
      <li class="links dropdown">
          <a href="/projects" style="padding-right: 0;"><i class="fa fa-cogs"></i>&nbsp;Projects</a>
          <a class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="padding-left: 2px;" id="dropdownMenu1">
            <span class="fa fa-sort-down"></span>
            <span class="sr-only">Toggle Projects Dropdown</span>
          </a>
          <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
              <li class="dropdown-header">NGS data analysis</li>
            <li><a href="/ngsutilsj">ngsutilsj (newer)</a></li>
            <li><a href="/ngsutils">NGSUtils (older)</a></li>
            <li><a href="/cgsplice">cgsplice</a></li>
            <li><a href="/sqz">SQZ</a></li>
            <li role="separator" class="divider"></li>
            <li class="dropdown-header">Data analysis pipelines</li>
            <li><a href="/cgpipe">cgpipe</a></li>
            <li><a href="/sbs">SBS</a></li>
            <li role="separator" class="divider"></li>
            <li class="dropdown-header">Misc. tools</li>
            <li><a href="/basespace-download">Basespace-download</a></li>
            
            <li><a href="/swalign">swalign</a></li>
            <li><a href="/tabutils">tabutils</a></li>
            <li role="separator" class="divider"></li>
            <li class="dropdown-header">Programming libraries</li>
            <li><a href="/compgen-common">compgen-common</a></li>
            <li><a href="/compgen-cmdline">compgen-cmdline</a></li>
          </ul>
      </li>
      <li class="links"><a href="/tutorials"><i class="fa fa-book"></i>&nbsp;Tutorials</a></li>

      <li class="links"><a href="/citations"><i class="fa fa-external-link-squaref"></i> Citations</a></li>
      <li class="links"><a href="/contact"><i class="fa fa-question-circle"></i>&nbsp;Contact</a></li>


  </ul>
  <div class="clearing">&nbsp;</div>
</div>
</div>

<div class="main_wrap">
  <section id="main">
  <div class="breadcrumbs">
      <a href="/tutorials">Back to tutorials...</a>
  </div>
    <h1 id="title">RNA-Seq workflow (with STAR)</h1>
    <div>
          <article id="content" class="tutorial">
             

<h2 id="experimental-design">Experimental design</h2>

<p>The first step in getting good results from an RNA-Seq experiment is choosing a good experimental
design. This means that you need to have enough replicates, with sufficient sequencing depth to
be able to answer your research question.</p>

<h3 id="depth">Depth</h3>

<p>For differential gene expression, I recommend having at least 4 biological replicates for each
condition with a minimum of 20M reads per sample (30M recommended). Additionally, we&rsquo;ve found that pair-end sequencing
produces more uniquely aligned reads than single-end sequencing. If you want to investigate
changes in splicing, I recommend at least 40M reads per sample (50M recommended).</p>

<h3 id="batch-effects">Batch effects</h3>

<p>Additionally, you need to try to reduce any possible batch effects in your data. One common batch
effect is due to a lane-effect present when samples are sequenced only on a single lane. If your
control and experimental samples are sequenced on different lanes, there is no way to differentiate
between a lane-effect and biological signal. A different experimental design can be used to avoid
batch effects by pooling (and barcoding) all of your samples together. Then you can sequence that
pool as many times as necessary to get the required sequencing depth. So, for example, if you require
two lanes worth of data, you would sequence all samples across all lanes.</p>

<h2 id="pre-processing">Pre-processing</h2>

<p>RNA-Seq reads should undergo the same pre-processing/QC filtering steps that you&rsquo;d use in DNA-Seq.</p>

<p>It is almost more important to measure and track QC metrics with RNA-Seq data than with DNA-Seq.
Because RNA-Seq is most commonly used for gene expression analysis, it is important to make sure that
each same has a similar QC profile. It isn&rsquo;t necessarily important to hit exact
QC benchmarks, but rather it is more important to make sure that all samples have a <em>similar</em> profile.
If one of your samples has vastly more rRNA or many more adapter truncted sequences, this could affect
your downstream analysis. If all of the samples have a similar profile, then you can be more confident
that your results are due to biological differences, not technical differences.</p>

<h2 id="ribosomal-rna-filtering">Ribosomal RNA filtering</h2>

<p>Ribosomal RNA is always a concern with RNA-Seq. rRNA is vastly more abundant in total RNA extractions
than mRNA or other non-coding RNAs. Because of this, it is sometimes useful to remove rRNA sequences
before mapping the remaining reads. Even if you don&rsquo;t filter out rRNA reads, it is a useful QC
metric to observe and track.</p>

<p>rRNA filtering can be done using an rRNA reference index and an alignment tool like <code>bwa</code>. <code>bwa</code> is
used instead of an RNA-specific aligner because we don&rsquo;t need to keep track of splicing in this
step.  The source of a good rRNA reference varys based on the organism, but possible sources
include searching NCBI Genbank for molecules of the type <em>rRNA</em>, species-specific rRNA databases,
or pulling ribosomal regions from references genomes using RepeatMasker.</p>

          </article>
    </div>
  </section>
</div>

<div class="footer_wrap">
<div class="footer">
<div>

<b>compgen.io</b>&nbsp;&nbsp;&middot;&nbsp;&nbsp;Copyright&nbsp;&copy;2016-2018
<br/><br/>

github: <a href="https://github.com/compgen-io">compgen-io</a> &middot; 
<a href="https://github.com/mbreese">mbreese</a> &middot; 
<a href="https://github.com/ngsutils">ngsutils</a>
</div>
</div>
</div>

</body>
