<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>What is cgpipe? - cgpipe</title> <link rel="shortcut icon" href="/cgpipe/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/cgpipe/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-83662616-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-83662616-1'); </script> <script type="text/javascript" src="/cgpipe/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/cgpipe/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>What is cgpipe? | cgpipe</title> <meta name="generator" content="Jekyll v3.8.7" /> <meta property="og:title" content="What is cgpipe?" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Documentation for the cgpipe project" /> <meta property="og:description" content="Documentation for the cgpipe project" /> <link rel="canonical" href="/cgpipe/docs/getting-started/what-is-cgpipe" /> <meta property="og:url" content="/cgpipe/docs/getting-started/what-is-cgpipe" /> <meta property="og:site_name" content="cgpipe" /> <script type="application/ld+json"> {"@type":"WebPage","url":"/cgpipe/docs/getting-started/what-is-cgpipe","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/cgpipe/assets/img/compgen-cgpipe.png"}},"headline":"What is cgpipe?","description":"Documentation for the cgpipe project","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="link" viewBox="0 0 16 16"> <title>Link</title> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path> </symbol> </svg> <div class="page-wrap"> <div class="side-bar"> <div class="site-header"> <a href="/cgpipe/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button> </div> <div class="navigation main-nav js-main-nav"> <nav role="navigation" aria-label="Main navigation"> <ul class="navigation-list"><li class="navigation-list-item "><a href="https://compgen.io/" class="navigation-list-link">Home</a></li><li class="navigation-list-item "><a href="https://compgen.io/projects" class="navigation-list-link">Projects</a></li><li class="navigation-list-item subsite"><a href="/cgpipe/" class="navigation-list-link">Projects: cgpipe</a></li><li class="navigation-list-item active subsite_child"><a href="/cgpipe/docs/getting-started" class="navigation-list-link">Getting started</a><ul class="navigation-list-child-list "><li class="navigation-list-item active"><a href="/cgpipe/docs/getting-started/what-is-cgpipe" class="navigation-list-link active">What is cgpipe?</a> <ul class="navigation-list-child-list"><li class="navigation-list-item "><a href="/cgpipe/docs/getting-started/quick" class="navigation-list-link">Quick version</a></li></ul></li><li class="navigation-list-item "><a href="/cgpipe/docs/getting-started/installing" class="navigation-list-link">Installation</a> </li><li class="navigation-list-item "><a href="/cgpipe/docs/getting-started/running" class="navigation-list-link">Running cgpipe</a> </li></ul></li><li class="navigation-list-item subsite_child"><a href="/cgpipe/docs/features" class="navigation-list-link">Features</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/cgpipe/docs/features/job-log" class="navigation-list-link">Job log</a> </li><li class="navigation-list-item "><a href="/cgpipe/docs/features/remote-pipelines" class="navigation-list-link">Remote pipelines</a> </li></ul></li><li class="navigation-list-item subsite_child"><a href="/cgpipe/docs/syntax" class="navigation-list-link">Language syntax</a></li><li class="navigation-list-item subsite_child"><a href="/cgpipe/docs/running-jobs" class="navigation-list-link">Job scheduling</a></li><li class="navigation-list-item nav_gap subsite_child"><a href="/cgpipe/docs/tutorials" class="navigation-list-link">Tutorials</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/cgpipe/tutorials/flexible-pipelines" class="navigation-list-link">Tutorial: Flexible pipelines</a> </li><li class="navigation-list-item "><a href="/cgpipe/tutorials/docker-cgpipe" class="navigation-list-link">Tutorial: Docker with cgpipe</a> </li></ul></li><li class="navigation-list-item subsite_child"><a href="https://github.com/compgen-io/cgpipe/releases" class="navigation-list-link">Download</a></li><li class="navigation-list-item nav_gap"><a href="https://compgen.io/contact" class="navigation-list-link">Contact / Help</a></li></ul> </nav> </div> <footer class="site-footer"> <p class="text-small text-grey-dk-000 mb-4"> <!-- <a href="https://compgen.io/"><img src="assets/img/compgen-icon.png" style="float:left; width: 32px;"/> compgen.io</a><br/>data wrangling for <br/>computational genomics --> <a href="https://compgen.io/" class="footer_link"><img src="/cgpipe//assets/img/compgen-slug.png"/></a> </p> </footer> </div> <div class="main-content-wrap js-main-content" tabindex="0"> <div class="main-content"> <div class="page-header js-page-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search cgpipe docs" aria-label="Search cgpipe" autocomplete="off"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg> </div> <div class="js-search-results search-results-wrap"></div> </div> <ul class="list-style-none text-small aux-nav"> <li class="d-inline-block my-0"><a href="//github.com/compgen-io/cgpipe">View cgpipe on GitHub</a></li> </ul> </div> <div class="page"> <nav class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/cgpipe/docs/getting-started">Getting started</a></li> <li class="breadcrumb-nav-list-item"><span>What is cgpipe?</span></li> </ol> </nav> <div id="main-content" class="page-content" role="main"> <h1 id="what-is-cgpipe"> <a href="#what-is-cgpipe" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> What is cgpipe? </h1> <p><a href="quick">Quick version</a></p> <p>CGPipe is a language for building data analysis pipelines. It is a declarative programming language similar to Makefiles, however instead of directly executing target scripts, jobs are submitted to a dedicated job scheduler, such as PBS, SGE, or SLURM.</p> <p>You define output files, which input files they need, and the script required to get from input &gt; output. Each output file (or job) is defined separately. Taken together, these job definitions form a directed acyclic graph (DAG).</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>input &gt; file1 --&gt; file2 &gt; file3 &gt; ... &gt; output1
             \
              \-&gt; file1b &gt; output2
</code></pre></div></div> <p>or map-reduce style…</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># split input
input &gt; file1 + file2 + file3

# map
file1 &gt; fileA
file2 &gt; fileB
file3 &gt; fileC

#reduce
fileA + fileB + fileC &gt; output
</code></pre></div></div> <p>You give CGPipe these definitions and the name of the file you ultimately want. Knowing these task definitions and the desired output, CGPipe will figure out how to "walk the graph" to figure out what files/jobs are needed. It also backtracks the walk in case there are multiple ways to get to your output. CGPipe will look first <em>on-disk</em> for required input files. It will only submit a job to build a missing or out of date file. If an input is newer than an output, that output file is considered out of date. So far, this is the same as how <code class="language-plaintext highlighter-rouge">make</code> works, except for the job submission part… where <code class="language-plaintext highlighter-rouge">make</code> executes the tasks, CGPipe submits them as jobs to a scheduler.</p> <h2 id="similarities-and-differences-to-makefiles"> <a href="#similarities-and-differences-to-makefiles" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Similarities and differences to Makefiles </h2> <p>CGPipe pipelines have a very simliar syntax to Makefiles, particularly in the way that build-targets are defined.</p> <ul> <li> <p>Jobs are defined based on the files they will produce as output. The pipeline author can define which output files will be created, and which input files are required for a particular task. After that, a shell script snippet is included that defines the commands that need to be executed to produce the defined output files.</p> </li> <li> <p>Jobs dependencies are automatically calculated and a build-graph produced. Jobs are then executed in the proper order along that build-graph to produce the required outputs.</p> </li> <li> <p>CGPipe pipelines can be included in other pipelines.</p> </li> <li> <p>If a given output file exists, it will not be rebuilt unless a defined input file will be rebuilt. CGPipe extends this to also track outputs/jobs that have been submitted to a job scheduler. If an built-target requires an input that has already been submitted to the scheduler, that input will not be resubmitted, rather the existing job will be listed as a job dependency.</p> </li> </ul> <p>In this way, CGPipe is very similar to the <code class="language-plaintext highlighter-rouge">qmake</code> program that is available for SGE clusters, which executes unmodified Makefiles using the SGE scheduler. This allows for some parallelization. But there are some key differences between CGPipe pipelines and using <code class="language-plaintext highlighter-rouge">qmake</code> to execute an unaltered Makefile.</p> <ul> <li> <p>CGPipe allows you to specify job requirements, such as execution time, CPUs, and memory. These requirements can be set on a job or pipeline basis, allowing the pipeline author to set requirements globally or for only individual tasks. For example, the <code class="language-plaintext highlighter-rouge">account</code> setting can be set for all tasks, but <code class="language-plaintext highlighter-rouge">walltime</code> could be set on a per-task basis.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">qmake</code> runs interactively, submitting jobs in order and waiting for the results before submitting the next job. Because of this, <code class="language-plaintext highlighter-rouge">qmake</code> needs to keep running on the job submission host. With CGPipe, the entire pipeline is submitted to the job scheduler at once. There is no need to have a watchdog script running, as the job scheduler will automatically cancel any dependent jobs in the event of an error.</p> </li> <li> <p>Command line arguments can be easily used to set variables within the script.</p> </li> <li> <p>Makefiles don't include any type of flow control (if/else, for-loops), but CGPipe is a full language that includes if/else conditions and for-loops for iterating over a list of values or a range. Everything in a CGPipe line can be scripted, including target definitions. This means that an author could define a pipeline that executed in a Map-Reduce pattern where an input file is split into <code class="language-plaintext highlighter-rouge">N</code> number of chunks, each chunk could be processed in parallel, and then the results could be merged back together after each chunk was processed. This type of pipeline could be written in a traditional Makefile (verbosely), but by allowing build targets to be included in for-loops, the number of chunks can now be a run-time option and written in an easily readable syntax.</p> </li> <li> <p>Build targets are scriptable with CGPipe templates</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">qmake</code> is only available for SGE clusters and isn't available for other job schedulers. CGPipe pipelines can execute on SGE or SLURM systems as well as on single hosts with SBS or bash script exports (see below).</p> </li> <li> <p>Multiple targets can be defined for the same output files, enabling multiple execution paths to build the same output files. This means that there can be multiple set of jobs defined to yield the same output file(s), based upon what input files are available. For example, you could have paired-end next-generation sequencing reads stored in two separate FASTQ files or one interleaved FASTQ file. Either of these inputs could be used in a read alignment step to produce a BAM file, but the arguments for the alignment program may be slightly different, depending on which type of input is used. With CGPipe, you can specify two different targets for the same output file, with the targets prioritized in the order they are defined in the pipeline. If the first target (or any of its inputs) can't be used, then the next target is attempted until all possible build-graphs are exhausted.</p> </li> <li> <p>Pipelines can be stored remotely, such as on a GitHub repository or web server.</p> </li> <li> <p>Pipelines can be used as executable scripts using the #! (shebang) first line syntax (like bash, perl, ruby, or python scripts).</p> </li> <li> <p>Pipelines can display help text. If the first lines are comments, then they will be displayed when help text is requested (excluding #! first lines). The first blank or non-commented line marks the end of the help text.</p> </li> </ul> <h2 id="executing-pipelines"> <a href="#executing-pipelines" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Executing pipelines </h2> <p>It is expected that jobs will be executed on an HPC cluster with a job scheduler (SGE, SLURM, or PBS supported). This way individual tasks can be efficiently executed in a parallel manner. CGPipe will take care of setting inter-task dependencies to make sure that jobs execute in the proper order. Pipelines can also be run on a single host by using either the simple <a href="http://compgen.io/sbs">SBS scheduler</a> or by exporting the pipeline as a bash script. SBS is well suited for single-host systems where there is no existing job scheduler. SBS requires having the <code class="language-plaintext highlighter-rouge">sbs</code> program installed somewhere in your <code class="language-plaintext highlighter-rouge">$PATH</code>.</p> <hr> <h2 class="text-delta">Table of contents</h2> <ul> <li> <a href="/cgpipe/docs/getting-started/quick">Quick version</a> </li> </ul> </div> </div> </div> </div> </body> </html>
